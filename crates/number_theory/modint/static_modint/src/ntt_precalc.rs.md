---
data:
  _extendedDependsOn:
  - icon: ':heavy_check_mark:'
    path: crates/number_theory/modint/static_modint/src/lib.rs
    title: crates/number_theory/modint/static_modint/src/lib.rs
  - icon: ':heavy_check_mark:'
    path: crates/number_theory/modint/static_modint/src/mod_arithmetic.rs
    title: crates/number_theory/modint/static_modint/src/mod_arithmetic.rs
  - icon: ':heavy_check_mark:'
    path: crates/number_theory/modint/static_modint/src/numeric.rs
    title: crates/number_theory/modint/static_modint/src/numeric.rs
  - icon: ':heavy_check_mark:'
    path: crates/number_theory/modint/static_modint/src/ops.rs
    title: crates/number_theory/modint/static_modint/src/ops.rs
  _extendedRequiredBy:
  - icon: ':heavy_check_mark:'
    path: crates/convolution/convolution/src/lib.rs
    title: crates/convolution/convolution/src/lib.rs
  - icon: ':heavy_check_mark:'
    path: crates/number_theory/modint/static_modint/src/lib.rs
    title: crates/number_theory/modint/static_modint/src/lib.rs
  - icon: ':heavy_check_mark:'
    path: crates/number_theory/modint/static_modint/src/mod_arithmetic.rs
    title: crates/number_theory/modint/static_modint/src/mod_arithmetic.rs
  - icon: ':heavy_check_mark:'
    path: crates/number_theory/modint/static_modint/src/numeric.rs
    title: crates/number_theory/modint/static_modint/src/numeric.rs
  - icon: ':heavy_check_mark:'
    path: crates/number_theory/modint/static_modint/src/ops.rs
    title: crates/number_theory/modint/static_modint/src/ops.rs
  - icon: ':heavy_check_mark:'
    path: crates/polynomial/formal_power_series/src/lib.rs
    title: crates/polynomial/formal_power_series/src/lib.rs
  _extendedVerifiedWith:
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/convolution/bitwise_and_convolution/src/main.rs
    title: verify/library_checker/convolution/bitwise_and_convolution/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/convolution/bitwise_or_convolution/src/main.rs
    title: verify/library_checker/convolution/bitwise_or_convolution/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/convolution/bitwise_xor_convolution/src/main.rs
    title: verify/library_checker/convolution/bitwise_xor_convolution/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/convolution/convolution_mod/src/main.rs
    title: verify/library_checker/convolution/convolution_mod/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/convolution/convolution_mod_1000000007/src/main.rs
    title: verify/library_checker/convolution/convolution_mod_1000000007/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/convolution/gcd_convolution/src/main.rs
    title: verify/library_checker/convolution/gcd_convolution/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/convolution/lcm_convolution/src/main.rs
    title: verify/library_checker/convolution/lcm_convolution/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/data_structure/deque_operate_all_composite/src/main.rs
    title: verify/library_checker/data_structure/deque_operate_all_composite/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/data_structure/dynamic_sequence_range_affine_range_sum/src/main.rs
    title: verify/library_checker/data_structure/dynamic_sequence_range_affine_range_sum/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/data_structure/point_set_range_composite/src/main.rs
    title: verify/library_checker/data_structure/point_set_range_composite/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/data_structure/point_set_range_composite_large_array/src/main.rs
    title: verify/library_checker/data_structure/point_set_range_composite_large_array/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/data_structure/range_affine_point_get/src/main.rs
    title: verify/library_checker/data_structure/range_affine_point_get/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/data_structure/range_affine_range_sum/src/main.rs
    title: verify/library_checker/data_structure/range_affine_range_sum/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/data_structure/unionfind_with_potential/src/main.rs
    title: verify/library_checker/data_structure/unionfind_with_potential/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/data_structure/unionfind_with_potential_non_commutative_group/src/main.rs
    title: verify/library_checker/data_structure/unionfind_with_potential_non_commutative_group/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/linear_algebra/inverse_matrix/src/main.rs
    title: verify/library_checker/linear_algebra/inverse_matrix/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/linear_algebra/matrix_det/src/main.rs
    title: verify/library_checker/linear_algebra/matrix_det/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/linear_algebra/matrix_product/src/main.rs
    title: verify/library_checker/linear_algebra/matrix_product/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/linear_algebra/matrix_rank/src/main.rs
    title: verify/library_checker/linear_algebra/matrix_rank/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/linear_algebra/pow_of_matrix/src/main.rs
    title: verify/library_checker/linear_algebra/pow_of_matrix/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/polynomial/exp_of_formal_power_series/src/main.rs
    title: verify/library_checker/polynomial/exp_of_formal_power_series/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/polynomial/inv_of_formal_power_series/src/main.rs
    title: verify/library_checker/polynomial/inv_of_formal_power_series/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/polynomial/log_of_formal_power_series/src/main.rs
    title: verify/library_checker/polynomial/log_of_formal_power_series/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/polynomial/pow_of_formal_power_series/src/main.rs
    title: verify/library_checker/polynomial/pow_of_formal_power_series/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/polynomial/sqrt_of_formal_power_series/src/main.rs
    title: verify/library_checker/polynomial/sqrt_of_formal_power_series/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/tree/frequency_table_of_tree_distance/src/main.rs
    title: verify/library_checker/tree/frequency_table_of_tree_distance/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/tree/point_set_tree_path_composite_sum/src/main.rs
    title: verify/library_checker/tree/point_set_tree_path_composite_sum/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/tree/point_set_tree_path_composite_sum_fixed_root/src/main.rs
    title: verify/library_checker/tree/point_set_tree_path_composite_sum_fixed_root/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/tree/tree_path_composite_sum/src/main.rs
    title: verify/library_checker/tree/tree_path_composite_sum/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/tree/vertex_set_path_composite/src/main.rs
    title: verify/library_checker/tree/vertex_set_path_composite/src/main.rs
  _isVerificationFailed: false
  _pathExtension: rs
  _verificationStatusIcon: ':heavy_check_mark:'
  attributes:
    links: []
  bundledCode: "Traceback (most recent call last):\n  File \"/opt/hostedtoolcache/Python/3.13.3/x64/lib/python3.13/site-packages/onlinejudge_verify/documentation/build.py\"\
    , line 71, in _render_source_code_stat\n    bundled_code = language.bundle(stat.path,\
    \ basedir=basedir, options={'include_paths': [basedir]}).decode()\n          \
    \         ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\
    \  File \"/opt/hostedtoolcache/Python/3.13.3/x64/lib/python3.13/site-packages/onlinejudge_verify/languages/rust.py\"\
    , line 288, in bundle\n    raise NotImplementedError\nNotImplementedError\n"
  code: "use crate::mod_arithmetic::{inv_mod, is_prime, mul_mod, pow_mod, primitive_root};\n\
    \npub struct NTTPrecalc {\n    pub is_prime: bool,\n    pub rank2: usize,\n  \
    \  pub primitive_root: u32,\n    pub root: [u32; 30],\n    pub iroot: [u32; 30],\n\
    \    pub rate2: [u32; 30],\n    pub irate2: [u32; 30],\n    pub rate3: [u32; 30],\n\
    \    pub irate3: [u32; 30],\n}\n\nimpl NTTPrecalc {\n    pub const fn new(modulus:\
    \ u32) -> Self {\n        let is_prime = is_prime(modulus);\n\n        if !is_prime\
    \ {\n            return Self {\n                is_prime,\n                rank2:\
    \ 0,\n                primitive_root: 0,\n                root: [0; 30],\n   \
    \             iroot: [0; 30],\n                rate2: [0; 30],\n             \
    \   irate2: [0; 30],\n                rate3: [0; 30],\n                irate3:\
    \ [0; 30],\n            };\n        }\n\n        let rank2 = (modulus - 1).trailing_zeros()\
    \ as usize;\n        let primitive_root = primitive_root(modulus);\n        let\
    \ mut root = [0; 30];\n        let mut iroot = [0; 30];\n        let mut rate2\
    \ = [0; 30];\n        let mut irate2 = [0; 30];\n        let mut rate3 = [0; 30];\n\
    \        let mut irate3 = [0; 30];\n\n        root[rank2] = pow_mod(primitive_root,\
    \ ((modulus - 1) >> rank2) as _, modulus);\n        iroot[rank2] = inv_mod(root[rank2],\
    \ modulus);\n        let mut i = rank2;\n        while i > 0 {\n            i\
    \ -= 1;\n            root[i] = mul_mod(root[i + 1], root[i + 1], modulus);\n \
    \           iroot[i] = mul_mod(iroot[i + 1], iroot[i + 1], modulus);\n       \
    \ }\n\n        let mut prod = 1;\n        let mut iprod = 1;\n        let mut\
    \ i = 0;\n        while i + 2 <= rank2 {\n            rate2[i] = mul_mod(root[i\
    \ + 2], prod, modulus);\n            irate2[i] = mul_mod(iroot[i + 2], iprod,\
    \ modulus);\n            prod = mul_mod(prod, iroot[i + 2], modulus);\n      \
    \      iprod = mul_mod(iprod, root[i + 2], modulus);\n            i += 1;\n  \
    \      }\n\n        let mut prod = 1;\n        let mut iprod = 1;\n        let\
    \ mut i = 0;\n        while i + 3 <= rank2 {\n            rate3[i] = mul_mod(root[i\
    \ + 3], prod, modulus);\n            irate3[i] = mul_mod(iroot[i + 3], iprod,\
    \ modulus);\n            prod = mul_mod(prod, iroot[i + 3], modulus);\n      \
    \      iprod = mul_mod(iprod, root[i + 3], modulus);\n            i += 1;\n  \
    \      }\n\n        Self {\n            is_prime,\n            rank2,\n      \
    \      primitive_root,\n            root,\n            iroot,\n            rate2,\n\
    \            irate2,\n            rate3,\n            irate3,\n        }\n   \
    \ }\n}\n"
  dependsOn:
  - crates/number_theory/modint/static_modint/src/lib.rs
  - crates/number_theory/modint/static_modint/src/mod_arithmetic.rs
  - crates/number_theory/modint/static_modint/src/numeric.rs
  - crates/number_theory/modint/static_modint/src/ops.rs
  isVerificationFile: false
  path: crates/number_theory/modint/static_modint/src/ntt_precalc.rs
  requiredBy:
  - crates/number_theory/modint/static_modint/src/mod_arithmetic.rs
  - crates/number_theory/modint/static_modint/src/lib.rs
  - crates/number_theory/modint/static_modint/src/numeric.rs
  - crates/number_theory/modint/static_modint/src/ops.rs
  - crates/polynomial/formal_power_series/src/lib.rs
  - crates/convolution/convolution/src/lib.rs
  timestamp: '2025-05-12 06:37:24+00:00'
  verificationStatus: LIBRARY_ALL_AC
  verifiedWith:
  - verify/library_checker/tree/frequency_table_of_tree_distance/src/main.rs
  - verify/library_checker/tree/tree_path_composite_sum/src/main.rs
  - verify/library_checker/tree/point_set_tree_path_composite_sum/src/main.rs
  - verify/library_checker/tree/point_set_tree_path_composite_sum_fixed_root/src/main.rs
  - verify/library_checker/tree/vertex_set_path_composite/src/main.rs
  - verify/library_checker/linear_algebra/matrix_rank/src/main.rs
  - verify/library_checker/linear_algebra/matrix_product/src/main.rs
  - verify/library_checker/linear_algebra/inverse_matrix/src/main.rs
  - verify/library_checker/linear_algebra/matrix_det/src/main.rs
  - verify/library_checker/linear_algebra/pow_of_matrix/src/main.rs
  - verify/library_checker/polynomial/sqrt_of_formal_power_series/src/main.rs
  - verify/library_checker/polynomial/pow_of_formal_power_series/src/main.rs
  - verify/library_checker/polynomial/exp_of_formal_power_series/src/main.rs
  - verify/library_checker/polynomial/log_of_formal_power_series/src/main.rs
  - verify/library_checker/polynomial/inv_of_formal_power_series/src/main.rs
  - verify/library_checker/data_structure/deque_operate_all_composite/src/main.rs
  - verify/library_checker/data_structure/dynamic_sequence_range_affine_range_sum/src/main.rs
  - verify/library_checker/data_structure/point_set_range_composite/src/main.rs
  - verify/library_checker/data_structure/unionfind_with_potential_non_commutative_group/src/main.rs
  - verify/library_checker/data_structure/range_affine_point_get/src/main.rs
  - verify/library_checker/data_structure/point_set_range_composite_large_array/src/main.rs
  - verify/library_checker/data_structure/range_affine_range_sum/src/main.rs
  - verify/library_checker/data_structure/unionfind_with_potential/src/main.rs
  - verify/library_checker/convolution/lcm_convolution/src/main.rs
  - verify/library_checker/convolution/bitwise_or_convolution/src/main.rs
  - verify/library_checker/convolution/convolution_mod/src/main.rs
  - verify/library_checker/convolution/bitwise_and_convolution/src/main.rs
  - verify/library_checker/convolution/gcd_convolution/src/main.rs
  - verify/library_checker/convolution/bitwise_xor_convolution/src/main.rs
  - verify/library_checker/convolution/convolution_mod_1000000007/src/main.rs
documentation_of: crates/number_theory/modint/static_modint/src/ntt_precalc.rs
layout: document
redirect_from:
- /library/crates/number_theory/modint/static_modint/src/ntt_precalc.rs
- /library/crates/number_theory/modint/static_modint/src/ntt_precalc.rs.html
title: crates/number_theory/modint/static_modint/src/ntt_precalc.rs
---
