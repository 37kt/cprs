---
data:
  _extendedDependsOn:
  - icon: ':heavy_check_mark:'
    path: crates/number_theory/modint/static_modint/src/lib.rs
    title: crates/number_theory/modint/static_modint/src/lib.rs
  - icon: ':heavy_check_mark:'
    path: crates/number_theory/modint/static_modint/src/ntt_precalc.rs
    title: crates/number_theory/modint/static_modint/src/ntt_precalc.rs
  - icon: ':heavy_check_mark:'
    path: crates/number_theory/modint/static_modint/src/numeric.rs
    title: crates/number_theory/modint/static_modint/src/numeric.rs
  - icon: ':heavy_check_mark:'
    path: crates/number_theory/modint/static_modint/src/ops.rs
    title: crates/number_theory/modint/static_modint/src/ops.rs
  _extendedRequiredBy:
  - icon: ':heavy_check_mark:'
    path: crates/convolution/convolution/src/lib.rs
    title: crates/convolution/convolution/src/lib.rs
  - icon: ':heavy_check_mark:'
    path: crates/number_theory/modint/static_modint/src/lib.rs
    title: crates/number_theory/modint/static_modint/src/lib.rs
  - icon: ':heavy_check_mark:'
    path: crates/number_theory/modint/static_modint/src/ntt_precalc.rs
    title: crates/number_theory/modint/static_modint/src/ntt_precalc.rs
  - icon: ':heavy_check_mark:'
    path: crates/number_theory/modint/static_modint/src/numeric.rs
    title: crates/number_theory/modint/static_modint/src/numeric.rs
  - icon: ':heavy_check_mark:'
    path: crates/number_theory/modint/static_modint/src/ops.rs
    title: crates/number_theory/modint/static_modint/src/ops.rs
  - icon: ':heavy_check_mark:'
    path: crates/polynomial/formal_power_series/src/lib.rs
    title: crates/polynomial/formal_power_series/src/lib.rs
  _extendedVerifiedWith:
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/convolution/bitwise_and_convolution/src/main.rs
    title: verify/library_checker/convolution/bitwise_and_convolution/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/convolution/bitwise_or_convolution/src/main.rs
    title: verify/library_checker/convolution/bitwise_or_convolution/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/convolution/bitwise_xor_convolution/src/main.rs
    title: verify/library_checker/convolution/bitwise_xor_convolution/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/convolution/convolution_mod/src/main.rs
    title: verify/library_checker/convolution/convolution_mod/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/convolution/convolution_mod_1000000007/src/main.rs
    title: verify/library_checker/convolution/convolution_mod_1000000007/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/convolution/gcd_convolution/src/main.rs
    title: verify/library_checker/convolution/gcd_convolution/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/convolution/lcm_convolution/src/main.rs
    title: verify/library_checker/convolution/lcm_convolution/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/data_structure/deque_operate_all_composite/src/main.rs
    title: verify/library_checker/data_structure/deque_operate_all_composite/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/data_structure/dynamic_sequence_range_affine_range_sum/src/main.rs
    title: verify/library_checker/data_structure/dynamic_sequence_range_affine_range_sum/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/data_structure/point_set_range_composite/src/main.rs
    title: verify/library_checker/data_structure/point_set_range_composite/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/data_structure/range_affine_point_get/src/main.rs
    title: verify/library_checker/data_structure/range_affine_point_get/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/data_structure/range_affine_range_sum/src/main.rs
    title: verify/library_checker/data_structure/range_affine_range_sum/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/data_structure/unionfind_with_potential/src/main.rs
    title: verify/library_checker/data_structure/unionfind_with_potential/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/data_structure/unionfind_with_potential_non_commutative_group/src/main.rs
    title: verify/library_checker/data_structure/unionfind_with_potential_non_commutative_group/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/linear_algebra/inverse_matrix/src/main.rs
    title: verify/library_checker/linear_algebra/inverse_matrix/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/linear_algebra/matrix_det/src/main.rs
    title: verify/library_checker/linear_algebra/matrix_det/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/linear_algebra/matrix_product/src/main.rs
    title: verify/library_checker/linear_algebra/matrix_product/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/linear_algebra/matrix_rank/src/main.rs
    title: verify/library_checker/linear_algebra/matrix_rank/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/linear_algebra/pow_of_matrix/src/main.rs
    title: verify/library_checker/linear_algebra/pow_of_matrix/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/polynomial/exp_of_formal_power_series/src/main.rs
    title: verify/library_checker/polynomial/exp_of_formal_power_series/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/polynomial/inv_of_formal_power_series/src/main.rs
    title: verify/library_checker/polynomial/inv_of_formal_power_series/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/polynomial/log_of_formal_power_series/src/main.rs
    title: verify/library_checker/polynomial/log_of_formal_power_series/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/polynomial/pow_of_formal_power_series/src/main.rs
    title: verify/library_checker/polynomial/pow_of_formal_power_series/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/polynomial/sqrt_of_formal_power_series/src/main.rs
    title: verify/library_checker/polynomial/sqrt_of_formal_power_series/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/tree/frequency_table_of_tree_distance/src/main.rs
    title: verify/library_checker/tree/frequency_table_of_tree_distance/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/tree/point_set_tree_path_composite_sum/src/main.rs
    title: verify/library_checker/tree/point_set_tree_path_composite_sum/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/tree/point_set_tree_path_composite_sum_fixed_root/src/main.rs
    title: verify/library_checker/tree/point_set_tree_path_composite_sum_fixed_root/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/tree/tree_path_composite_sum/src/main.rs
    title: verify/library_checker/tree/tree_path_composite_sum/src/main.rs
  - icon: ':heavy_check_mark:'
    path: verify/library_checker/tree/vertex_set_path_composite/src/main.rs
    title: verify/library_checker/tree/vertex_set_path_composite/src/main.rs
  _isVerificationFailed: false
  _pathExtension: rs
  _verificationStatusIcon: ':heavy_check_mark:'
  attributes:
    links: []
  bundledCode: "Traceback (most recent call last):\n  File \"/opt/hostedtoolcache/Python/3.13.2/x64/lib/python3.13/site-packages/onlinejudge_verify/documentation/build.py\"\
    , line 71, in _render_source_code_stat\n    bundled_code = language.bundle(stat.path,\
    \ basedir=basedir, options={'include_paths': [basedir]}).decode()\n          \
    \         ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\
    \  File \"/opt/hostedtoolcache/Python/3.13.2/x64/lib/python3.13/site-packages/onlinejudge_verify/languages/rust.py\"\
    , line 288, in bundle\n    raise NotImplementedError\nNotImplementedError\n"
  code: "pub(crate) const fn mul_mod(x: u32, y: u32, m: u32) -> u32 {\n    ((x as\
    \ u64) * (y as u64) % (m as u64)) as u32\n}\n\npub(crate) const fn pow_mod(x:\
    \ u32, mut e: usize, m: u32) -> u32 {\n    let mut res = 1;\n    let mut x = (x\
    \ % m) as u64;\n    let m = m as u64;\n    while e > 0 {\n        if e & 1 !=\
    \ 0 {\n            res = res * x % m;\n        }\n        x = x * x % m;\n   \
    \     e >>= 1;\n    }\n    res as u32\n}\n\npub(crate) const fn is_prime(x: u32)\
    \ -> bool {\n    match x {\n        ..=1 => return false,\n        2 | 7 | 61\
    \ => return true,\n        _ if x & 1 == 0 => return false,\n        _ => {}\n\
    \    }\n\n    let mut d = x - 1;\n    while d & 1 == 0 {\n        d >>= 1;\n \
    \   }\n\n    let a = [2, 7, 61];\n    let mut i = 0;\n    while i < a.len() {\n\
    \        let mut t = d;\n        let mut y = pow_mod(a[i], t as _, x);\n     \
    \   while t != x - 1 && y != 1 && y != x - 1 {\n            y = mul_mod(y, y,\
    \ x);\n            t <<= 1;\n        }\n        if y != x - 1 && t & 1 == 0 {\n\
    \            return false;\n        }\n        i += 1;\n    }\n\n    true\n}\n\
    \npub(crate) const fn primitive_root(m: u32) -> u32 {\n    match m {\n       \
    \ 2 => return 1,\n        167_772_161 => return 3,\n        469_762_049 => return\
    \ 3,\n        754_974_721 => return 11,\n        998_244_353 => return 3,\n  \
    \      _ => {}\n    }\n\n    let mut pf = [0; 20];\n    pf[0] = 2;\n    let mut\
    \ n = 1;\n    let mut x = m - 1;\n    while x & 1 == 0 {\n        x >>= 1;\n \
    \   }\n\n    let mut i = 3;\n    while i * i <= x {\n        if x % i == 0 {\n\
    \            pf[n] = i;\n            n += 1;\n            while x % i == 0 {\n\
    \                x /= i;\n            }\n        }\n        i += 2;\n    }\n \
    \   if x > 1 {\n        pf[n] = x;\n        n += 1;\n    }\n\n    let mut g =\
    \ 2;\n    loop {\n        let mut i = 0;\n        while i < n {\n            if\
    \ pow_mod(g, ((m - 1) / pf[i]) as _, m) == 1 {\n                break;\n     \
    \       }\n            i += 1;\n        }\n        if i == n {\n            break\
    \ g;\n        }\n        g += 1;\n    }\n}\n\npub(crate) const fn inv_mod(x: u32,\
    \ m: u32) -> u32 {\n    let (mut a, mut b, mut x, mut y) = (1, 0, x, m);\n   \
    \ if m == 1 {\n        return 0;\n    }\n\n    loop {\n        match x {\n   \
    \         0 => panic!(\"gcd(x, m) is not 1.\"),\n            1 => return a,\n\
    \            _ => {}\n        }\n        b += a * (y / x);\n        y %= x;\n\n\
    \        match y {\n            0 => panic!(\"gcd(x, m) is not 1.\"),\n      \
    \      1 => return m - b,\n            _ => {}\n        }\n        a += b * (x\
    \ / y);\n        x %= y;\n    }\n}\n"
  dependsOn:
  - crates/number_theory/modint/static_modint/src/lib.rs
  - crates/number_theory/modint/static_modint/src/ntt_precalc.rs
  - crates/number_theory/modint/static_modint/src/numeric.rs
  - crates/number_theory/modint/static_modint/src/ops.rs
  isVerificationFile: false
  path: crates/number_theory/modint/static_modint/src/mod_arithmetic.rs
  requiredBy:
  - crates/polynomial/formal_power_series/src/lib.rs
  - crates/convolution/convolution/src/lib.rs
  - crates/number_theory/modint/static_modint/src/lib.rs
  - crates/number_theory/modint/static_modint/src/numeric.rs
  - crates/number_theory/modint/static_modint/src/ops.rs
  - crates/number_theory/modint/static_modint/src/ntt_precalc.rs
  timestamp: '2025-04-06 02:35:23+00:00'
  verificationStatus: LIBRARY_ALL_AC
  verifiedWith:
  - verify/library_checker/polynomial/sqrt_of_formal_power_series/src/main.rs
  - verify/library_checker/polynomial/pow_of_formal_power_series/src/main.rs
  - verify/library_checker/polynomial/log_of_formal_power_series/src/main.rs
  - verify/library_checker/polynomial/exp_of_formal_power_series/src/main.rs
  - verify/library_checker/polynomial/inv_of_formal_power_series/src/main.rs
  - verify/library_checker/tree/point_set_tree_path_composite_sum/src/main.rs
  - verify/library_checker/tree/tree_path_composite_sum/src/main.rs
  - verify/library_checker/tree/vertex_set_path_composite/src/main.rs
  - verify/library_checker/tree/frequency_table_of_tree_distance/src/main.rs
  - verify/library_checker/tree/point_set_tree_path_composite_sum_fixed_root/src/main.rs
  - verify/library_checker/convolution/convolution_mod_1000000007/src/main.rs
  - verify/library_checker/convolution/bitwise_and_convolution/src/main.rs
  - verify/library_checker/convolution/bitwise_or_convolution/src/main.rs
  - verify/library_checker/convolution/lcm_convolution/src/main.rs
  - verify/library_checker/convolution/gcd_convolution/src/main.rs
  - verify/library_checker/convolution/convolution_mod/src/main.rs
  - verify/library_checker/convolution/bitwise_xor_convolution/src/main.rs
  - verify/library_checker/data_structure/point_set_range_composite/src/main.rs
  - verify/library_checker/data_structure/range_affine_range_sum/src/main.rs
  - verify/library_checker/data_structure/dynamic_sequence_range_affine_range_sum/src/main.rs
  - verify/library_checker/data_structure/deque_operate_all_composite/src/main.rs
  - verify/library_checker/data_structure/range_affine_point_get/src/main.rs
  - verify/library_checker/data_structure/unionfind_with_potential_non_commutative_group/src/main.rs
  - verify/library_checker/data_structure/unionfind_with_potential/src/main.rs
  - verify/library_checker/linear_algebra/pow_of_matrix/src/main.rs
  - verify/library_checker/linear_algebra/inverse_matrix/src/main.rs
  - verify/library_checker/linear_algebra/matrix_det/src/main.rs
  - verify/library_checker/linear_algebra/matrix_product/src/main.rs
  - verify/library_checker/linear_algebra/matrix_rank/src/main.rs
documentation_of: crates/number_theory/modint/static_modint/src/mod_arithmetic.rs
layout: document
redirect_from:
- /library/crates/number_theory/modint/static_modint/src/mod_arithmetic.rs
- /library/crates/number_theory/modint/static_modint/src/mod_arithmetic.rs.html
title: crates/number_theory/modint/static_modint/src/mod_arithmetic.rs
---
